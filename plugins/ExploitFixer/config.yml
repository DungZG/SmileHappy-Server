# Download it here: https://black-minecraft.com/resources/1984/
# ExploitFixer (made with love) by LinsaFTW
# Donate: https://paypal.me/LinsaFTW
# Discord: https://discord.gg/gF36AT3
# WARNING: INSTALL THE PLUGIN ON ALL SPIGOT SERVERS!
Settings:
  # Default language for players
  locale: "en"
  # Web link for kick messages
  web: "discord.gg/gF36AT3"
  # Notification message for when a player fails a check
  notification: "&b&lExploitFixer &8Â» &e%player% &7(&a%ping%ms&7) &ffailed &6%check% &7(&c%vls% vls&7) &7%reason%"

discord-webhook:
  enabled: false
  url: "https://discord.com/api/webhooks/xxxxxxxxx/yyyyyyyyy" # Replace with your actual webhook
  message: "**%player%** (`%ping%ms`) failed **%check%** (%vls% VLS)\nReason: `%reason%`"

# Log in the console details about why players fail checks
Debug:
  # Enable debug information
  enabled: false
  modules:
    # Show debug about cooldowns (ex: PacketPlayInArmAnimation spam)
    PacketFilter: false
    # Each 10 seconds show a list of highest vl packets
    PacketFunnel: true

# Prevents players from requesting invalid recipes
InvalidRecipeID:
  enabled: true
  # Vls to add when an unexistant recipe is requested
  vls: 100

# Strip data from creative items (Fixes crash potions and items)
CreativeSanitizer:
  enabled: true
  # Maximum stack size obtainable with creative packets. (-1 to allow anything)
  max-stack-size: 64

  # This section contains all the specific limits that will be applied to item metadata.
  # These limits will be enforced by the ItemMeta Handlers.
  limits:
    # Maximum enchant level for any enchantment.
    # Set to -1 to disable enchantments entirely.
    # Set to 0 to force vanilla maximum levels (e.g., Sharpness V).
    enchant-limit: 0

    # Allows or disallows the 'unbreakable' tag on items.
    unbreakable-enabled: true

    # Allows or disallows the 'invisible' tag on item frames.
    invisible-item-frame-enabled: false

    # Maximum character length for an item's display name.
    max-display-name-length: 256

    # Maximum total character length for an item's entire lore block.
    max-lore-length: 2048

    # Maximum number of pages allowed in a written book.
    max-book-pages: 50

    # Maximum number of characters allowed on a single page of a book.
    max-book-page-length: 320

    # Maximum number of firework effects on a single firework rocket.
    max-firework-effects: 20

    # Maximum amplifier for any potion effect (on potions, stews, tipped arrows, etc.).
    max-potion-amplifier: 10

    # Maximum duration in ticks for any potion effect (20 ticks = 1 second).
    # Default: 12000 (10 minutes)
    max-potion-duration: 12000
  # Set a permission for some players to bypass this check. (Uncomment to enable)
  # WARNING: Players with this permission can crash and corrupt worlds FOREVER with hacked clients.
  #bypass-permission: "exploitfixer.bypass.creativesanitizer"
  # List of materials that are removed from Creative.
  blacklist:
    - "END_PORTAL"
    - "NETHER_PORTAL"
  #  - "BARRIER"
  #  - "COMMAND_BLOCK"

# Block vulnerable commands
CommandBlocker:
  enabled: true
  # Amount of vls to add per fail
  vls: 100
  # Commands that are blocked from being executed
  block_syntax: true
  # Set a permission for some players to bypass this check. (Uncomment to enable)
  bypass-permission: "exploitfixer.commandblocker.bypass"
  # Commands that are exempt from this server.
  commands:
    # WorldEdit exploit
    - "//calc" 
    - "//calculate" 
    - "//eval" 
    - "//evaluate" 
    - "//solve"
    # HolographicDisplays exploit
    - "/hd readtext" 
    - "/holo readtext" 
    - "/hologram readtext" 
    - "/holograms readtext" 
    - "/holographicdisplays readtext"
    # PermissionsEx exploit
    - "/pex promote" 
    - "/pex demote" 
    - "/promote" 
    - "/demote" 
    - "/execute"
    # Multiverse exploit
    - "/mv ^" 
    - "/mv help <" 
    - "/mvhelp <" 
    - "/$"

# Limits size of packets and items
PacketLimiter:
  enabled: true
  
  # Vls to add when a packet fails the check
  vls: 100

  # Maximum packet size (Items with hex colors can be flagged)
  max_size: 18kb

  # Character limit for tab complete
  tab_complete_limit: 256

  # Limit for fireworks
  firework_effect_limit: 12
  firework_power_limit: 3

  # Character limit for items
  item_limits:
    displayname: 256
    lore: 96

  # Character limit for books
  book_limits:
    title: 16
    author: 16
    pages: 50
    content: 300

  # Character limit per sign line
  max_size_sign: 45

  # Maximum amount of packets per second to kick
  max_pps: 4096
  # Maximum amount of bandwidth per second to kick
  max_bps: 40kb

  # Maximum amount of flags allowed per packet.
  max_flags:
    enabled: true
    # Applied to non-specified flags
    default: 64
    # Object Type limits
    total: 300 # Maximum total objects allowed
    object: 300 # Maximum limit for non-ARRAY objects
    array: 64 # Maximum limit for ARRAY objects
    # Actual Flags
    extra: 90 # Maximum limit for EXTRA flags
    translate: 5 # Maximum limit for TRANSLATE flags
    translate_placeholder: 5 # Maximum limit for TRANSLATE_PLACEHOLDER flags
    maplike: 32 # Maximum limit for MAPLIKE flags
    # Fireworks
    explosions: 8 # Maximum limit for EXPLOSIONS flags
    colors: 8 # Maximum limit for COLORS flags

# Completely filters some packets
PacketFilter:
  enabled: true
  # Geyser will not be checked for PacketPlayInAutoRecipe
  geyser-support: true
  # Filters packets from offline players
  offline_packets: true
  # Time between packet receives (in milliseconds)
  cooldowns:
    # Prevent auto recipe dupe/crash exploit
    PacketPlayInAutoRecipe: 500
    # Prevent brigaider tab complete exploit
    PacketPlayInTabComplete: 200
    # Prevents sending many arm animations to crash players
    PacketPlayInArmAnimation: 100
    ServerboundSwingPacket: 100
    # Prevents sending many settings to crash the server
    PacketPlayInSettings: 100
    ServerboundSettingsPacket: 100
    # These packets will be completely cancelled.
  # Change to blacklist: [] to completely disable the blacklist
  blacklist: []
    # Recipe Book can be used to duplicate items and crash the server.
    #- "PacketPlayInAutoRecipe"

# Counts vls for each packet and byte received
PacketFunnel:
  enabled: true
  # Adds one vls each data received
  data_multiplier: 500
  # This packets will be never cancelled
  # They will still add violations
  whitelist:
  - PacketPlayInKeepAlive
  - PacketPlayInTransaction
  - ServerboundKeepAlivePacket
  - ServerboundTransactionPacket
  - ServerboundClientTickEndPacket
  - ServerboundPongPacket
  # Prevents whitelisting big packets
  max-whitelist-capacity: 10
  # Violations to add when a normal packet is received from a player.
  packet_multipliers:
    # This is the value for packets not listed below
    Default: 0.01
    # CustomPayload
    MC|BSign: 4.5
    MC|BEdit: 4.5
    MC|BOpen: 4.5
    BungeeCord: 0.1
    # Legacy Packets
    PacketPlayInUpdateSign: 5
    PacketPlayInAbilities: 0.25
    PacketPlayInArmAnimation: 0.125
    PacketPlayInBlockDig: 0.125
    PacketPlayInBlockPlace: 0.5
    PacketPlayInCustomPayload: 0.01
    PacketPlayInEntityAction: 0.4
    PacketPlayInFlying: 0.2
    PacketPlayInLook: 0.2
    PacketPlayInSteerVehicle: 0.05
    PacketPlayInPositionLook: 0.05
    PacketPlayInPosition: 0.2
    PacketPlayInSetCreativeSlot: 0.15
    PacketPlayInSettings: 0.1
    PacketPlayInTabComplete: 0.75
    PacketPlayInUseEntity: 0.15
    PacketPlayInUseItem: 0.1
    PacketPlayInWindowClick: 0.15
    PacketPlayInAutoRecipe: 3
    PacketPlayInTransaction: 0.01 # Anti-Cheats
    # Modern Packets
    Pos: 0.2
    Rot: 0.2
    PosRot: 0.2
    ServerboundSwingPacket: 0.125
    ServerboundSetCreativeModeSlotPacket: 0.15
    ServerboundPongPacket: 0.01 # Anti-Cheats
    ServerboundPlayerActionPacket: 0.125
    ServerboundUseItemOnPacket: 0.5
    ServerboundUseItemPacket: 0.1
    ServerboundPlayerCommandPacket: 0.4
    ServerboundInteractPacket: 0.15
    ServerboundContainerClickPacket: 0.15
    ServerboundCommandSuggestionPacket: 0.75
    ServerboundSettingsPacket: 0.1

# Detects when players send packets with invalid tags
InvalidPayload:
  enabled: true
  # Vls to add when an invalid tag is sent
  vls: 100
  # Detect when players have no books in hand
  detect-book: true

# Detects when players send packets with invalid slots or actions in window clicks
InvalidInventoryClick:
  enabled: true
  # Auction or backpack plugins require swapping to be prevented
  # otherwise it can be used to get items from menus and use them.
  prevent-swap: true
  # This disables the check during player inventory on modern servers.
  # This prevents false positives on fake packet inventory plugins.
  # But will allow exploiters to send this exploit. (Exploit doesnt work on modern)
  modern-support: true
  # Vls to add when an invalid inventory click is sent
  vls: 25

# Detects when players send packets with invalid bundle selection
InvalidSelectBundle:
  enabled: true
  # Vls to add when an invalid bundle selection is sent
  vls: 100

# Detects when players send packets with invalid block placement
BlockPlace:
  enabled: true
  # Vls to add when an invalid block place packet is sent
  vls: 100

# Detects when players send infinite numbers to crash
InfiniteNumber:
  enabled: true
  # Vls to add when an infinite number is sent
  vls: 100

# Detects when players send packets with invalid block dig
BlockDig:
  enabled: true
  # Vls to add when an invalid block dig packet is sent
  vls: 100

# Detects when players send packets with invalid sequence
PacketSequence:
  enabled: true
  # Vls to add when a packet sequence is detected
  vls: 100

# Detects when players send packets with invalid creative slots
CreativeSlot:
  enabled: true
  # Vls to add when an invalid creative slot packet is sent
  vls: 100

# Detects when players send unexistant items
ItemAnalysis:
  enabled: true
  # Vls to add when an unexistant item is sent
  vls: 25
  # Checks and compares item metadata (Very Effective Security)
  # Incompatibilities: ViaVersion, LPX (Very Sensitive)
  meta:
    enabled: true
  # Do not check metadata for bedrock edition players
  geyser-support: true
  # Show detailed information about items
  detailed-item-analysis-output: false

# Slows down actions
ActionCooldowns:
  enabled: true
  # Do not apply click_inventory and same_slot_click to bedrock edition players
  geyser-support: true
  # Cooldown between actions in milliseconds
  # Threshold defines how many can be done before cooldown is applied
  cooldowns:
    # Prevents inventory duplication with books and bundles
    throw:
      cooldown: 100
      burst: 1
    throw_book_edit: 1000
    book_edit: 1000
    # Prevents sheep wool duplication
    shear: 200
    # Prevents spamming portal use chunk loading
    portal_use: 1000
    # Prevets spamming with lingerig potions
    lingering_potion_use: 10000
    # Prevent shooting too fast
    shoot:
      cooldown: 200
      burst: 3
    # Trident dupe related patches
    shoot_and_throw: 200
    throw_and_shoot: 200
    shoot_and_click: 200
    click_and_shoot: 200
    # Item Frame rotation and interaction
    click_frame: 250
    # Duplication with meteor client
    click_and_throw: 50
    throw_and_click: 50
    # Spamming the same slot is used for Bundle dupe
    same_slot_click:
      cooldown: 100
      burst: 2
    # Bundle specific fixes used for Bundle dupe
    bundle_and_click: 200
    click_and_bundle: 200
    bundle_and_throw: 200
    throw_and_bundle: 200
    # All inventory clicks have a cooldown
    click_inventory:
      cooldown: 75
      burst: 3
      creative-burst: 37

# Blacklists recipes
RecipeBlacklist:
  enabled: true
  # List of recipes results to blacklist
  blacklist:
    - BEDROCK

# Prevents exploits related to extremely fast movement that can lag or crash the server.
FlyCrash:
  enabled: true
  
  # The number of violation points (vls) to add when a player triggers this check.
  vls: 100

  # Limits how many *different*, unloaded chunks a player can enter per second.
  # This stops players from moving at extreme speeds into new terrain, which can lag
  # or crash the server by forcing it to load too much at once.
  #
  # - 3: (Default) Safe for all servers, allows for fast Elytra flight.
  # - 2: Stricter. Use if you want tighter control.
  max-null-chunks-per-second: 3

# Prevents all kind of crashers
GeneralPatcher:
  # Prevents players from damaging themselves and consuming ram
  self_damage: true
  # Prevents players from breaking ender portals
  ender_portal_break: true
  # Disables maps player locations when put in itemframes to fix chunk overflow crash
  disable_tracking: true
  # Prevents crashing when using dispensers that drop items out of the bounds
  dispenser_crash: true
  # Prevents placing/breaking/opening blocks while inventory is open
  inventory_interaction: true
  # Prevents duplication with mules
  close_unloaded_entities_inventories: true
  # Prevents doing insta-kill with bows
  bow_bomb: true
  # Prevents crops duplication with beds
  bed_duplication: true
  # Prevents crashers with redstone and trapdoors
  redstone_trapdoor_crash: true
  # Prevents duplicating strings with tripwire hooks
  string_duplicator: true
  # Prevent clicking invalid inventories
  prevent_invalid_click: true
  # Limits how many books can be stored in a chest. (Set to -1 to disable)
  book_storage_limit: 5
  # Prevent renaming containers to prevent command execution (force-op)
  rename_container: true
  # Mules using portals can be abused with salhack to duplicate items
  prevent_mule_portal_use: true
  # Prevents players from getting god mode
  invalid_vehicles: true
  # Prevents players from using a bad IP
  null_address: true
  # Prevents players from using inventory while shooting
  prevent_inventory_while_shooting: true

# Violation system (used for all modules)
# Dont change this part to fix false positives.
# Instead, change the module causing problems.
Violations:
  # How many vls to start cancelling packets
  cancel: 25
  # How many vls to reduce per second
  reduce: 20
  # What commands to run when reaching a certain violation level
  # Placeholders: %player%, %vls%, %reason%, %module%
  commands:
    25:
      - "notify"
    50:
      - "notify"
    75:
      - "notify"
    100:
      - "notify"
      - "kick"
      - "tempban %player% 1m Server Crasher Detected"